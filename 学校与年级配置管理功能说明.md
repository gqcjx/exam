# 学校与年级配置管理功能说明

## ✅ 功能已实现

学校与年级配置管理功能已完整实现，包括：

### 1. 数据库表 ✅

- ✅ `subjects` 表 - 学科配置（6条默认数据）
- ✅ `grades` 表 - 年级配置（12条默认数据）
- ✅ `schools` 表 - 学校配置（0条，需手动添加）
- ✅ `classes` 表 - 班级配置（0条，需手动添加）

所有表都包含：
- RLS 安全策略
- 索引优化
- 更新时间触发器

### 2. API 接口 ✅

文件：`src/api/config.ts`

提供完整的 CRUD 操作：
- 学科管理（getSubjects, createSubject, updateSubject, deleteSubject）
- 年级管理（getGrades, createGrade, updateGrade, deleteGrade）
- 学校管理（getSchools, createSchool, updateSchool, deleteSchool）
- 班级管理（getClasses, createClass, updateClass, deleteClass）

### 3. 管理界面 ✅

文件：`src/pages/AdminConfig.tsx`

- 标签页式设计（学科、年级、学校、班级）
- 表格展示
- 添加/编辑/删除功能
- 启用/禁用状态管理
- 显示顺序管理

### 4. 前端集成 ✅

已更新的文件：
- ✅ `src/components/QuestionForm.tsx` - 学科和年级从数据库读取
- ✅ `src/pages/AdminPapers.tsx` - 学科和年级改为下拉选择
- ✅ `src/pages/AdminQuestions.tsx` - 筛选器从数据库读取

### 5. 路由和导航 ✅

- ✅ 路由：`/admin/config`
- ✅ 导航：管理员和教师导航栏添加"配置"链接

---

## 📍 访问方式

1. 以管理员或教师身份登录
2. 点击导航栏中的"配置"链接
3. 进入系统配置页面

---

## 🎯 主要功能

### 学科管理
- 添加学科（名称、代码、显示顺序）
- 编辑学科
- 删除学科
- 启用/禁用学科

### 年级管理
- 添加年级（名称、代码、级别、显示顺序）
- 编辑年级
- 删除年级
- 启用/禁用年级

### 学校管理
- 添加学校（名称、代码、地址、联系电话）
- 编辑学校
- 删除学校
- 启用/禁用学校

### 班级管理
- 添加班级（学校、年级、名称、代码）
- 编辑班级
- 删除班级
- 启用/禁用班级

---

## 📊 默认数据

### 学科（6个）
- 数学、语文、英语、物理、化学、科学

### 年级（12个）
- 一年级到六年级（小学）
- 七年级到九年级（初中）
- 高一到高三（高中）

---

## 🔄 数据流程

1. **配置管理**：管理员在 `/admin/config` 页面管理学科、年级、学校、班级
2. **前端使用**：创建题目、创建试卷时，从数据库读取启用的学科和年级
3. **数据保存**：学科和年级以文本形式保存（保持兼容性）

---

## ⚠️ 注意事项

1. **删除限制**：删除学科/年级前，请确保没有题目或试卷使用
2. **启用/禁用**：禁用的项不会在下拉列表中显示，但已使用的数据不受影响
3. **显示顺序**：可以设置显示顺序，控制下拉列表中的排序

---

## 📚 相关文件

- 数据库迁移：`supabase/migrations/create_school_grade_config.sql`
- API 文件：`src/api/config.ts`
- 管理页面：`src/pages/AdminConfig.tsx`
- 路由配置：`src/routes.tsx`
- 布局组件：`src/layouts/AppLayout.tsx`

---

**实现状态：** ✅ 完成

