# 修改日志

## 2024年修改记录

### 最新修改

#### P0核心功能实现（2024年）
- **日期**: 2024年
- **功能**: 实现P0核心待完善功能
- **修改内容**:
  1. **错题本功能** (`exam/src/pages/WrongQuestions.tsx`, `exam/src/api/wrongQuestions.ts`)
     - 创建错题本页面，支持查看、筛选、标记掌握、删除错题
     - 自动在提交答案时将错题添加到错题本
     - 添加错题统计功能
     - 创建数据库迁移文件 `exam/supabase/migrations/create_wrong_questions_table.sql`
  
  2. **排行榜功能** (`exam/src/pages/Ranking.tsx`, `exam/src/api/ranking.ts`)
     - 创建排行榜页面，支持按试卷/学科/年级筛选
     - 显示排名、得分、正确率等信息
     - 前三名显示特殊标识
  
  3. **试卷导出功能** (`exam/src/api/export.ts`, `exam/src/pages/AdminPapers.tsx`)
     - 支持导出为PDF、Word、文本格式
     - 支持带答案/不带答案两种模式
     - 在试卷列表中添加导出按钮和下拉菜单
  
  4. **试卷时间限制完善** (`exam/src/pages/Exam.tsx`, `exam/src/pages/Dashboard.tsx`)
     - 在进入考试前检查开始时间和结束时间
     - 在Dashboard中显示时间限制信息
     - 完善时间校验逻辑

- **路由更新**: 
  - 添加 `/wrong-questions` 路由（学生）
  - 添加 `/ranking` 路由（所有角色）
  - 在学生导航中添加"错题本"和"排行榜"链接

#### P2增强功能实现（2024年）
- **日期**: 2024年
- **功能**: 实现P2增强功能
- **修改内容**:
  1. **通知提醒功能** (`exam/src/api/notifications.ts`, `exam/src/components/NotificationBell.tsx`)
     - 创建通知系统API（创建、获取、标记已读、删除通知）
     - 创建通知铃铛组件，显示未读通知数量
     - 在试卷发布时自动发送通知给学生
     - 在简答题批阅完成时发送通知
     - 创建数据库迁移文件 `exam/supabase/migrations/create_notifications_table.sql`
     - 在AppLayout中添加通知铃铛组件
  
  2. **成绩报表详细导出** (`exam/src/api/reports.ts`, `exam/src/pages/Report.tsx`, `exam/src/pages/Parent.tsx`)
     - 创建报表API，支持按学科、年级、题型、时间筛选
     - 创建成绩报表页面，显示详细统计和题型分析
     - 支持导出PDF和CSV格式
     - 在家长端添加PDF导出功能
     - 添加统计概览（试卷总数、平均得分、平均正确率等）

#### P1重要功能实现（2024年）
- **日期**: 2024年
- **功能**: 实现P1重要功能
- **修改内容**:
  1. **填空题模糊匹配优化** (`exam/src/lib/fuzzyMatch.ts`, `exam/src/api/papers.ts`)
     - 实现模糊匹配算法（Levenshtein距离）
     - 支持同义词匹配（城市名称、常见词汇等）
     - 支持包含匹配（如"北京"匹配"北京市"）
     - 支持相似度阈值配置（默认0.8）
  
  2. **考试防作弊功能完善** (`exam/src/pages/Exam.tsx`)
     - 完善防切屏检测（记录切屏次数，超过5次自动交卷）
     - 添加防复制粘贴功能（禁用copy/paste/cut事件）
     - 禁用右键菜单
     - 禁用开发者工具快捷键（F12、Ctrl+Shift+I等）
     - 添加警告提示显示
  
  3. **题目标签管理** (`exam/src/api/tags.ts`, `exam/src/pages/AdminQuestions.tsx`)
     - 创建标签管理API（获取、创建、更新、删除标签）
     - 在题库管理页面添加标签筛选功能
     - 添加标签管理对话框（创建、编辑、删除标签）
     - 显示标签使用统计
     - 创建数据库迁移文件 `exam/supabase/migrations/create_tags_table.sql`
  
  4. **试卷版本管理** (`exam/src/api/paperVersions.ts`, `exam/src/pages/AdminPapers.tsx`)
     - 创建试卷版本管理API（获取版本列表、创建新版本）
     - 在papers表中添加version和parent_paper_id字段
     - 在试卷列表中添加版本查看和创建新版本功能
     - 创建数据库迁移文件 `exam/supabase/migrations/add_paper_versioning.sql`

#### 修改首页标题
- **日期**: 2024年
- **文件**: `exam/src/pages/Landing.tsx`
- **修改内容**: 将首页标题从"仿照考试酷，打造统一、简洁、好用的中小学在线考试平台"改为"江西青锋测，打造统一、简洁、好用的中小学在线考试平台"
- **位置**: 第180行

---

## 待确认任务

### P0、P1、P2 优先级任务
已创建详细的功能清单文档：`exam/待完善功能清单.md`

**待确认**: 请查看功能清单，确认哪些功能需要优先实现。

