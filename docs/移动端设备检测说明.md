# 移动端设备检测功能说明

## 功能概述

系统已实现自动设备检测功能，当学生用户在手机或平板上登录时，会自动使用高保真原型界面；在桌面设备上则保持原有界面。

## 实现原理

### 1. 设备检测工具 (`src/utils/deviceDetection.ts`)

提供了以下检测函数：
- `detectDevice()`: 返回设备类型（'mobile' | 'tablet' | 'desktop'）
- `isMobileDevice()`: 判断是否为移动设备（手机或平板）
- `isMobile()`: 判断是否为手机
- `isTablet()`: 判断是否为平板
- `isDesktop()`: 判断是否为桌面设备

### 2. 检测逻辑

检测基于以下因素：
1. **User Agent 检测**：识别设备标识符
2. **屏幕宽度检测**：
   - ≤ 768px：手机
   - 768px - 1024px：平板（结合 touch 检测）
   - > 1024px：桌面

### 3. 界面切换

在 `src/pages/Exam.tsx` 中：
- 组件加载时检测设备类型
- 监听窗口大小变化（响应式）
- 如果是移动设备，渲染 `ExamMobile` 组件
- 如果是桌面设备，渲染原有的 `Exam` 界面

## 文件结构

```
src/
├── utils/
│   └── deviceDetection.ts          # 设备检测工具
├── pages/
│   ├── Exam.tsx                    # 桌面端考试界面（已更新，包含设备检测）
│   ├── ExamMobile.tsx              # 移动端考试界面（新增）
│   ├── Exam.css                    # 桌面端样式
│   └── ExamMobile.css              # 移动端样式（新增）
└── components/
    └── ConfirmDialog.tsx           # 确认对话框组件（已存在）
```

## 测试方法

### 1. 浏览器开发者工具测试

#### Chrome/Edge DevTools
1. 打开浏览器开发者工具（F12）
2. 点击设备工具栏图标（或按 Ctrl+Shift+M）
3. 选择移动设备预设：
   - iPhone 12/13/14（375x812px）→ 应显示移动端界面
   - iPad（768x1024px）→ 应显示移动端界面
   - Desktop（1920x1080px）→ 应显示桌面端界面

#### Firefox Responsive Design Mode
1. 按 F12 打开开发者工具
2. 点击响应式设计模式图标（或按 Ctrl+Shift+M）
3. 选择设备预设或自定义尺寸

### 2. 实际设备测试

#### 手机测试
- 在手机上打开网站
- 应自动显示移动端界面
- 界面应符合 375x812px 设计规范

#### 平板测试
- 在平板上打开网站
- 应自动显示移动端界面
- 界面应适配平板尺寸

#### 桌面测试
- 在电脑上打开网站
- 应显示原有的桌面端界面
- 保持原有功能和样式

### 3. 响应式测试

1. 打开桌面端界面
2. 缩小浏览器窗口宽度
3. 当宽度 ≤ 768px 时，应自动切换到移动端界面
4. 放大窗口时，应切换回桌面端界面

## 移动端界面特色

### 设计风格
- **主色调**：蓝绿色 (#2E8B57)
- **辅助色**：浅黄色 (#FFFACD)、活力橙 (#FFA500)
- **字体**：Montserrat（标题）、Roboto（正文）

### 核心功能
1. **顶部固定信息栏**
   - 考试科目
   - 考生姓名
   - 倒计时器（最后5分钟变红警告）

2. **题目展示**
   - 题干加粗突出
   - 自定义单选/多选按钮样式
   - 选中状态明确

3. **题号导航**
   - 底部固定答题卡
   - 5列网格布局
   - 已答题标记（绿色背景 + 对勾）
   - 当前题目高亮（深蓝色背景）

4. **交互优化**
   - 平滑的题目切换动画
   - 交卷二次确认对话框
   - 触摸友好的按钮尺寸

## 注意事项

1. **首次加载**：设备检测在客户端进行，首次渲染可能会有短暂延迟
2. **窗口调整**：监听窗口大小变化，实时切换界面
3. **功能一致性**：移动端和桌面端功能完全一致，只是界面样式不同
4. **性能优化**：移动端样式独立，不影响桌面端性能

## 调试方法

### 查看设备信息
在浏览器控制台运行：
```javascript
import { getDeviceInfo } from './src/utils/deviceDetection'
console.log(getDeviceInfo())
```

### 强制切换界面
如需测试，可以临时修改 `Exam.tsx`：
```typescript
// 强制使用移动端界面
if (true) {  // 改为 true 强制移动端
  return <ExamMobile />
}
```

## 后续优化建议

1. **缓存设备类型**：使用 localStorage 缓存设备类型，减少重复检测
2. **服务端检测**：在服务端也进行设备检测，提供更快的首屏渲染
3. **更多断点**：根据实际需求调整断点值
4. **性能监控**：监控移动端和桌面端的性能差异
